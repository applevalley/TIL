# 1. SQL과 DBMS

### SQL

- SQL: 데이터베이스의 언어
  - 관계형 데이터베이스에서 데이터를 조작하고, 쿼리를 날리는 표준 언어
  - 사용자가 원하고, 필요로 하는 것을 RDBMS에게 요청(쿼리)을 보낸다.
  - RDBMS는 많지만 기본 개념을 숙지하면 큰 틀에서의 활용에는 문제가 없다.
- ANSI SQL: ANSI에 의해 최초로 표준화된 SQL 문법
  - ANSI 표준으로 작성된 SQL은 모든 데이터베이스에서 호환된다.
  - 기본적인 데이터 조회 구문은 ANSI SQL을 이요해 작성이 가능하나, 특정 DBMS에서만 제공하는 함수를 사용하려는 경우는 데이터 조회가 불가능하다!
- 명령어의 종류
  - DDL(Data Definition Language) : 데이터 정의 언어
    - CREATE : 데이터베이스 내 개체(테이블, 프로시저, 펑션 등)을 생성할 때
    - DROP : 데이터베이스 내 개체를 삭제할 때
    - ALTER : 데이터베이스 내 개체의 속성, 정의를 변경할 때
    - RENAME : 데이터베이스 내 개체의 이름을 변경할 때
    - TRUNCATE : 테이블 내 모든 데이터를 빠르게 삭제할 때
  - DML(Data Manipulation Language) : 데이터 조작 언어
    - INSERT : 특정 테이블에 데이터를 신규로 삽입할 때
    - UPDATE : 특정 테이블 내 데이터의 전체 또는 일부를 새로운 값으로 갱신할 때
    - DELETE : 특정 테이블 내 데이터의 전체 또는 일부를 삭제할 때
    - SELECT : 특정 테이블 내 데이터의 전체 또는 일부를 획득(선택)할 때
  - DCL(Data Control Language) : 데이터 제어 언어
    - GRANT : 데이터베이스 사용자에게 특정 작업의 수행 권한을 부여할 때
    - REVOKE : 데이터베이스 사용자에게 부여된 수행 권한을 박탈할 때
    - SET TRANSACTION : 트랜잭션 모드로 설정할 때
    - BEGIN : 트랜잭션의 시작을 의미
    - COMMIT : 트랜잭션을 실행할 때
    - ROLLBACK : 트랜잭션을 취소할 때
    - SAVEPOINT : 콜백 지점을 설정할 때
    - LOCK : 테이블 자원을 점유할 때
    - DCL의 다른 명령어들은 단독으로 사용되는 경우가 많다.

- 예문들

```mysql
CREATE TABLE My_table (
	my_field1 INT,
    my_field2 VARCHAR(50),
    my_field3 DATE NOT NULL,
    PRIMARY KEY (my_field1, my_field2)
);

ALTER TABLE My_table ADD my_field4 NUMBER(3) NOT NULL;

DROP TABLE My_table;

TRUNCATE TABLE My_table;

ALTER TABLE My_table RENAME TO Your_table;
```

```mysql
INSERT INTO 테이블명 VALUES 테이블명에 넣을 value   # 특정 column을 선택해 입력할 때
INSERT INTO 테이블명 VALUES COLUMN에 넣을 value   # 테이블내 모든 column에 값을 입력

UPDATE 테이블명 SET column명 = '갱신할 값' WHERE..;

DELETE FROM 테이블명 WHERE...;

SELECT column FROM 테이블명 WHERE..;
```

```mysql
GRANT SELECT ON NAME.EMP TO EXPERT   # EXPERT에게 NAME.EMP에 대한 권한 부여

REVOKE 뺏을 권한 ON 객체 이름 FROM 누구  # 누구로부터 객체에 대한 권한을 뺏을 것
```

- 트랜잭션이 뭐야?
  - 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위
  - DB의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위, 한꺼번에 모두 수행되어야 할 일련의 연산을 의미
  - 하나의 트랜잭션은 커밋되거나 롤백된다.
  - 트랜잭션의 성질
    - Atomocity(원자성)
      - 트랜잭션의 연산은 DB에 모두 반영되거나, 전혀 반영되지 않아야 한다.
      - 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.
      - 더 이상 쪼갤 수 없는 업무처리의 단위라는 말은 원자성에 기인한다.
    - Consistency(일관성)
      - 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있는 DB 상태로 변환한다.
      - 시스템이 가지고 있는 고정 요소는 트랜잭션 수행 전이나 수행 완료 후의 상태가 동일해야 한다.
    - Isolation(격리성, 독립성)
      - 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행 중에 다른 트랜잭션의 연산이 끼어들 수 없다.
      - 수행 중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.
    - Durablility(영속성, 지속성)
      - 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반환되어야 한다.
  - 트랜잭션의 연산 및 상태
    - Commit 연산
      - 커밋 연산은 한 개의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고, DB가 다시 일관된 상태에 있을 때, 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산이다.
    - Rollback 연산
      - 롤백 연산은 하나의 트랜잭션 처리가 비정상적으로 종료되어 DB의 일관성을 깨뜨렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소하는 연산이다.
      - 롤백시에는 해당 트랜잭션을 재시작하거나 폐기한다.
  - 트랜잭션의 상태
    - `활동 -> 부분 완료 -> 완료` 또는 `활동 -> 실패 -> 철회`
    - 활동(Active) : 트랜잭션이 실행중인 상태
    - 실패(Failed) : 트랜잭션 실행에 오류가 발생해 중단된 상태
    - 철회(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태
    - 부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태
    - 완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태

 

### DBMS

- 데이터베이스는 데이터의 집합 / 데이터의 저장공간 자체를 의미
  - DBMS는 이 데이터베이스를 관리, 운영하는 역할을 함
- DBMS 없이도 개발이 가능할까?
  - 할 수는 있을것이다
  - 메모장 등을 활용한 파일 시스템을 구성해 데이터를 채워넣을 수 있다
  - 파일 시스템은 대개 하나의 응용 프로그램마다 하나의 데이터 파일이 할당된다
  - 시간이 지나 데이터의 양이 많아지게 되면 데이터의 중복에 의한 불일치 발생 가능성이 크다
  - 개발자의 실수로 해킹을 당하거나, 고객의 데이터가 망가질 우려도 크다
  - 소량의 데이터를 처리하는 데에는 DBMS보다 속도가 빠르고 별도의 추가비용이 없어 여전히 사용되는 경우가 있다
- 그러면 DBMS를 사용하면 뭐가 좋을까?
  - 데이터들을 안전하게 관리해준다
  - 고속으로 데이터들을 읽고 쓸 수 있다
  - 데이터들을 편리하고, 빠르고, 안전하고, 무료로 쓸 수 있다
  - 데이터 검색 알고리즘/암호화 등을 직접 구현하지 않아도 된다
- 데이터베이스의 특징
  - 무결성
    - 데이터베이스의 데이터는 어떤 루트로 들어왔던 데이터에 오류가 있어서는 안 된다.
    - 이 무결성을 위해 데이터베이스는 제약 조건이라는 특성을 가진다.
      - 구조 및 제약조건(스키마)를 만들고 값을 채워넣는다.
  - 독립성
    - 데이터베이스의 크기를 변경하거나, 데이터 파일의 저장소를 변경하더라도 기존에 작성된 응용 프로그램은 전혀 영향을 받지 않아야 한다.
    - 서로 의존적 관계가 아닌 독립적인 관계여야 한다.
  - 보안성
    - 데이터베이스 안의 데이터에 아무나 접근할 수 있어서는 안 된다. 데이터를 소유한 사람이나 데이터에 접근이 허가된 사람만 접근할 수 있어야 하고, 사용자의 계정에 따라 접근 권한을 달리해야 한다.
  - 데이터 중복의 최소화
    - 동일한 데이터가 여러 개 중복되어 저장하는 것을 방지
  - 응용 프로그램 제작 및 수정이 쉬워짐
    - 통일된 방식으로 응용 프로그램 작성이 가능해지고, 유지보수도 쉬워짐
- 데이터베이스의 분류
  - 크게 계층형, 망형, 관계형, 객체지향형, 객체관계형으로 분류됨
    - 계층형
      - 가장 처음으로 나온 DBMS 개념
      - 각 계층은 트리 형태를 가지며, 1:N 관계를 가짐
      - 처음 구축한 이후에는 그 구조를 변경하기가 매우 까다롭다는 단점이 있음
      - 주어진 상태에서의 검색은 빠르지만, 접근의 유연성이 부족해 임의의 검색에는 어려움이 있음
    - 망형
      - 계층형의 문제점을 개선하기 위해 시작되었음
      - 1:1, 1:N, N:M(다대다)관계가 지원되어 효과적이고 빠른 데이터 추출이 가능해짐
      - 하지만 계층형과 마찬가지로 여전히 복잡한 내부 포인터를 사용하고 있어 프로그래머가 구조를 이해해야만 프로그램의 작성이 가능하다는 단점이 있음
    - 관계형
      - 오늘날 가장 많이 사용되고 있음
      - 테이블(릴레이션, 엔티티)라 불리는 최소 단위로 구성되어 있음
      - 행(로우), 열(컬럼)
      - 모든 데이터는 테이블에 저장되므로 테이블이 가장 기본적이고 중요한 구성이 된다
      - 테이블은 데이터를 효율적으로 저장하기 위한 구조인데, 정보를 저장하기 위해 하나의 테이블이 아닌 여러 개의 테이블로 나누어 저장함으로 불필요한 공간 낭비를 줄이고 데이터 저장의 효율성을 보장
      - 나누어진 테이블의 관계를 기본키와 외래키로 맺어줌으로 부모-자식 관계 형성 가능
      - 쉽게 변화에 순응 가능하며 유지보수 측면에서도 편리함
      - 다만 시스템 자원을 많이 차지하기에 시스템이 전반적으로 느려진다는 단점이 있음