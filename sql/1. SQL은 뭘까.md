# 1. SQL은 뭘까?

- SQL: 데이터베이스의 언어
  - 관계형 데이터베이스에서 데이터를 조작하고, 쿼리를 날리는 표준 언어
  - 사용자가 원하고, 필요로 하는 것을 RDBMS에게 요청(쿼리)을 보낸다.
  - RDBMS는 많지만 기본 개념을 숙지하면 큰 틀에서의 활용에는 문제가 없다.
- ANSI SQL: ANSI에 의해 최초로 표준화된 SQL 문법
  - ANSI 표준으로 작성된 SQL은 모든 데이터베이스에서 호환된다.
  - 기본적인 데이터 조회 구문은 ANSI SQL을 이요해 작성이 가능하나, 특정 DBMS에서만 제공하는 함수를 사용하려는 경우는 데이터 조회가 불가능하다!
- 명령어의 종류
  - DDL(Data Definition Language) : 데이터 정의 언어
    - CREATE : 데이터베이스 내 개체(테이블, 프로시저, 펑션 등)을 생성할 때
    - DROP : 데이터베이스 내 개체를 삭제할 때
    - ALTER : 데이터베이스 내 개체의 속성, 정의를 변경할 때
    - RENAME : 데이터베이스 내 개체의 이름을 변경할 때
    - TRUNCATE : 테이블 내 모든 데이터를 빠르게 삭제할 때
  - DML(Data Manipulation Language) : 데이터 조작 언어
    - INSERT : 특정 테이블에 데이터를 신규로 삽입할 때
    - UPDATE : 특정 테이블 내 데이터의 전체 또는 일부를 새로운 값으로 갱신할 때
    - DELETE : 특정 테이블 내 데이터의 전체 또는 일부를 삭제할 때
    - SELECT : 특정 테이블 내 데이터의 전체 또는 일부를 획득(선택)할 때
  - DCL(Data Control Language) : 데이터 제어 언어
    - GRANT : 데이터베이스 사용자에게 특정 작업의 수행 권한을 부여할 때
    - REVOKE : 데이터베이스 사용자에게 부여된 수행 권한을 박탈할 때
    - SET TRANSACTION : 트랜잭션 모드로 설정할 때
    - BEGIN : 트랜잭션의 시작을 의미
    - COMMIT : 트랜잭션을 실행할 때
    - ROLLBACK : 트랜잭션을 취소할 때
    - SAVEPOINT : 콜백 지점을 설정할 때
    - LOCK : 테이블 자원을 점유할 때
    - DCL의 다른 명령어들은 단독으로 사용되는 경우가 많다.

- 예문들

```mysql
CREATE TABLE My_table (
	my_field1 INT,
    my_field2 VARCHAR(50),
    my_field3 DATE NOT NULL,
    PRIMARY KEY (my_field1, my_field2)
);

ALTER TABLE My_table ADD my_field4 NUMBER(3) NOT NULL;

DROP TABLE My_table;

TRUNCATE TABLE My_table;

ALTER TABLE My_table RENAME TO Your_table;
```

```mysql
INSERT INTO 테이블명 VALUES 테이블명에 넣을 value   # 특정 column을 선택해 입력할 때
INSERT INTO 테이블명 VALUES COLUMN에 넣을 value   # 테이블내 모든 column에 값을 입력

UPDATE 테이블명 SET column명 = '갱신할 값' WHERE..;

DELETE FROM 테이블명 WHERE...;

SELECT column FROM 테이블명 WHERE..;
```

```mysql
GRANT SELECT ON NAME.EMP TO EXPERT   # EXPERT에게 NAME.EMP에 대한 권한 부여

REVOKE 뺏을 권한 ON 객체 이름 FROM 누구  # 누구로부터 객체에 대한 권한을 뺏을 것
```

- 트랜잭션이 뭐야?
  - 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위
  - DB의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위, 한꺼번에 모두 수행되어야 할 일련의 연산을 의미
  - 하나의 트랜잭션은 커밋되거나 롤백된다.
  - 트랜잭션의 성질
    - Atomocity(원자성)
      - 트랜잭션의 연산은 DB에 모두 반영되거나, 전혀 반영되지 않아야 한다.
      - 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.
      - 더 이상 쪼갤 수 없는 업무처리의 단위라는 말은 원자성에 기인한다.
    - Consistency(일관성)
      - 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있는 DB 상태로 변환한다.
      - 시스템이 가지고 있는 고정 요소는 트랜잭션 수행 전이나 수행 완료 후의 상태가 동일해야 한다.
    - Isolation(격리성, 독립성)
      - 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행 중에 다른 트랜잭션의 연산이 끼어들 수 없다.
      - 수행 중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.
    - Durablility(영속성, 지속성)
      - 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반환되어야 한다.
  - 트랜잭션의 연산 및 상태
    - Commit 연산
      - 커밋 연산은 한 개의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고, DB가 다시 일관된 상태에 있을 때, 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산이다.
    - Rollback 연산
      - 롤백 연산은 하나의 트랜잭션 처리가 비정상적으로 종료되어 DB의 일관성을 깨뜨렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소하는 연산이다.
      - 롤백시에는 해당 트랜잭션을 재시작하거나 폐기한다.
  - 트랜잭션의 상태
    - `활동 -> 부분 완료 -> 완료` 또는 `활동 -> 실패 -> 철회`
    - 활동(Active) : 트랜잭션이 실행중인 상태
    - 실패(Failed) : 트랜잭션 실행에 오류가 발생해 중단된 상태
    - 철회(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태
    - 부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태
    - 완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태

 